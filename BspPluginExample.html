<!DOCTYPE html>
<html>
  <head>
    <title>BSP Plugin Example</title>
    <script src="lib/usertiming.js"></script>
    <script src="lib/jquery.min.js"></script>
    <script src="lib/bsp-utils.js"></script>
    <script src="lib/perftest.js"></script>
  </head>
  <body>
    <div id="output"></div>
    <div id="result"></div>
    <script>
      var output = document.getElementById('output')
      var pluginAttr = 'data-my-plugin'
      var p = Object.create(perftest)
      p.run({
        setup () {
          var self = this
          bsp_utils.plugin(false, 'my', 'plugin', {
            '_each': function () {
              var plugin = Object.create({
                init () {
                  self.testDone()
                }
              })
              plugin.init()
            }
          })
        },
        test () {
          var div = document.createElement('div')
          div.setAttribute(pluginAttr, '')
          output.append(div)
        },
        done () {
          var result = document.getElementById('result')
          result.innerHTML = 'created ' + this.total + ' elements with <strong>bsp-plugin</strong> in ' + this.result().toFixed(3) + ' seconds'
        }
      })
    </script>
  </body>
</html>
